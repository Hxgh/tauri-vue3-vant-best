Tauri 地图导航唤起功能总结（兼容原生+H5，处理用户取消）

一、核心问题根源

Tauri 移动端本质是内嵌 WebView（Android Chromium/iOS WKWebView），直接触发地图 Scheme（如androidamap://）时：  
• WebView 无法处理第三方 App 的 Scheme，会fallback 到系统浏览器打开，无法直接唤起地图 App。  

二、核心解决方案：原生能力唤起 + 自动 Fallback

通过 Tauri 后端调用系统原生 API，绕过 WebView，直接唤起地图 App；若唤起失败（未安装/用户取消），自动跳转浏览器网页版。  

1. 原生唤起逻辑

• Android：用 Intent 启动地图 App（通过 android-activity 库监听用户响应）；  

• iOS：用 UIApplication.shared.open 打开地图 Scheme（通过 completion handler 捕获用户取消）。  

2. 自动 Fallback

原生唤起失败时（未安装 App/用户取消），用 shell.open 打开地图网页版 URL（如高德 https://uri.amap.com/route、百度 https://map.baidu.com/dir）。  

三、关键能力：判断用户是否取消唤起

通过系统级回调捕获用户交互结果，返回给前端：  
• Android：用 Activity Result API 监听 startActivity 的结果（success=true=同意，false=取消/失败）；  

• iOS：用 open 的 completion handler 返回 success（false=用户取消/失败）。  

四、跨平台实现要点

平台 原生唤起方式 用户取消判断 Fallback 方式

Android Intent + Activity Result 监听 startActivity 结果 shell.open 打开网页版

iOS UIApplication.shared.open completion handler 的 success shell.open 打开网页版

桌面端 直接打开网页版 无 无
  

五、体验优化建议

1. 用户取消提示：若用户点击「取消」，前端弹出轻提示（如“已取消导航”），避免疑惑；  
2. 未安装引导：若未安装地图 App，提示用户下载（如跳转到应用商店）；  
3. H5 场景兼容：H5 链接直接用 shell.open 打开网页版，无需原生处理；  
4. 加载状态：唤起过程中显示 Loading，提升用户感知。  

六、总结：最佳实践流程

1. 用户点击原生按钮：优先用原生 API 唤起地图 App；  
2. 监听用户响应：  
   • 成功：直接打开地图导航；  

   • 取消：提示用户；  

   • 未安装：提示下载并跳转浏览器；  

3. H5 链接点击：直接打开浏览器网页版。  

最终结论

通过原生能力唤起 + 自动 Fallback + 用户响应捕获，可实现：  
• 类似美团的「直接唤起地图」体验；  

• 兼容 H5 场景的浏览器跳转；  

• 完善的用户取消/未安装处理。  

这套方案兼顾了原生体验和H5 兼容，是 Tauri 移动端实现地图导航的最优解。