# ğŸ“± Android çœŸæœºè°ƒè¯•æŒ‡å—

æœ¬æ–‡æ¡£å°†æŒ‡å¯¼ä½ å¦‚ä½•åœ¨å°ç±³ Android æ‰‹æœºä¸Šè°ƒè¯• Express Appã€‚

## âœ… ç¯å¢ƒæ£€æŸ¥ï¼ˆå·²å®Œæˆï¼‰

- âœ… Android SDK å·²å®‰è£…
- âœ… Android NDK 29.0.14206865 å·²å®‰è£…
- âœ… ADB å·¥å…·å·²é…ç½®
- âœ… Rust Android ç¼–è¯‘ç›®æ ‡å·²å®‰è£…
- âœ… Tauri Android é¡¹ç›®å·²åˆå§‹åŒ–
- âœ… å¼€å‘æœåŠ¡å™¨ç«¯å£ï¼š1420

---

## ğŸ”§ ç¬¬ä¸€æ­¥ï¼šå¼€å¯å°ç±³æ‰‹æœºçš„ USB è°ƒè¯•

### 1. å¼€å¯å¼€å‘è€…é€‰é¡¹

1. æ‰“å¼€**è®¾ç½®** â†’ **æˆ‘çš„è®¾å¤‡** â†’ **å…¨éƒ¨å‚æ•°**
2. è¿ç»­ç‚¹å‡» **MIUI ç‰ˆæœ¬** 7æ¬¡
3. æç¤ºã€Œä½ å·²å¤„äºå¼€å‘è€…æ¨¡å¼ã€

### 2. å¼€å¯ USB è°ƒè¯•

1. è¿”å›è®¾ç½® â†’ **æ›´å¤šè®¾ç½®** â†’ **å¼€å‘è€…é€‰é¡¹**
2. æ‰“å¼€ä»¥ä¸‹å¼€å…³ï¼š
   - âœ… **USB è°ƒè¯•**
   - âœ… **USB å®‰è£…**ï¼ˆå…è®¸é€šè¿‡ USB å®‰è£…åº”ç”¨ï¼‰
   - âœ… **USB è°ƒè¯•ï¼ˆå®‰å…¨è®¾ç½®ï¼‰**ï¼ˆå¯é€‰ï¼Œå»ºè®®æ‰“å¼€ï¼‰

### 3. å…¶ä»–æ¨èè®¾ç½®ï¼ˆå¯é€‰ä½†å»ºè®®å¼€å¯ï¼‰

- âœ… **åœç”¨ adb æˆæƒè¶…æ—¶åŠŸèƒ½**ï¼ˆé¿å…é¢‘ç¹æˆæƒï¼‰
- âœ… **ä¸é”å®šå±å¹•**ï¼ˆå……ç”µæ—¶å±å¹•ä¿æŒå”¤é†’ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼‰

---

## ğŸ”Œ ç¬¬äºŒæ­¥ï¼šè¿æ¥æ‰‹æœºåˆ° macOS

### 1. ä½¿ç”¨ USB æ•°æ®çº¿è¿æ¥

- ä½¿ç”¨**åŸè£…æ•°æ®çº¿**æˆ–æ”¯æŒæ•°æ®ä¼ è¾“çš„æ•°æ®çº¿
- è¿æ¥æ‰‹æœºåˆ° Mac çš„ USB å£

### 2. æ‰‹æœºä¸Šæˆæƒè°ƒè¯•

è¿æ¥åï¼Œæ‰‹æœºå±å¹•ä¼šå¼¹å‡ºæç¤ºï¼š

```
å…è®¸ USB è°ƒè¯•å—ï¼Ÿ
è¿™å°è®¡ç®—æœºçš„ RSA å¯†é’¥æŒ‡çº¹å¦‚ä¸‹ï¼š
XX:XX:XX:...

[ ] ä¸€å¾‹å…è®¸ä½¿ç”¨è¿™å°è®¡ç®—æœºè¿›è¡Œè°ƒè¯•

[å–æ¶ˆ]  [ç¡®å®š]
```

**é‡è¦**ï¼š
- âœ… **å‹¾é€‰ã€Œä¸€å¾‹å…è®¸ä½¿ç”¨è¿™å°è®¡ç®—æœºè¿›è¡Œè°ƒè¯•ã€**
- âœ… ç‚¹å‡»**ã€Œç¡®å®šã€**

---

## ğŸ§ª ç¬¬ä¸‰æ­¥ï¼šéªŒè¯è¿æ¥

åœ¨ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
adb devices
```

**æˆåŠŸç¤ºä¾‹**ï¼š
```
List of devices attached
a1b2c3d4    device
```

**å¸¸è§é—®é¢˜**ï¼š

### é—®é¢˜ 1ï¼šæ˜¾ç¤º `unauthorized`
```
List of devices attached
a1b2c3d4    unauthorized
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ‰‹æœºä¸Šé‡æ–°æˆæƒ USB è°ƒè¯•
2. æˆ–è€…è¿è¡Œï¼š`adb kill-server && adb devices`

### é—®é¢˜ 2ï¼šæ˜¾ç¤º `no permissions`
```
List of devices attached
a1b2c3d4    no permissions
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
adb kill-server
sudo adb start-server
adb devices
```

### é—®é¢˜ 3ï¼šæ²¡æœ‰ä»»ä½•è®¾å¤‡
```
List of devices attached
```

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æ•°æ®çº¿æ˜¯å¦æ”¯æŒæ•°æ®ä¼ è¾“
2. æ›´æ¢ USB å£
3. æ£€æŸ¥æ‰‹æœºæ˜¯å¦å·²å¼€å¯ USB è°ƒè¯•
4. é‡å¯ ADBï¼š`adb kill-server && adb devices`

---

## ğŸš€ ç¬¬å››æ­¥ï¼šè¿è¡Œ Android å¼€å‘æ¨¡å¼

### æ–¹æ³• 1ï¼šä½¿ç”¨ Tauri CLIï¼ˆæ¨èï¼‰

```bash
cd /Users/hugh/workspace/test/express
npx @tauri-apps/cli android dev
```

è¿™ä¸ªå‘½ä»¤ä¼šï¼š
1. ğŸ”¨ ç¼–è¯‘ Rust ä»£ç 
2. ğŸ“¦ æ„å»º Android APK
3. ğŸ“² è‡ªåŠ¨å®‰è£…åˆ°æ‰‹æœº
4. ğŸ”¥ å¯åŠ¨åº”ç”¨å¹¶è¿æ¥çƒ­é‡è½½

**é¦–æ¬¡è¿è¡Œ**ï¼šå¯èƒ½éœ€è¦ 5-15 åˆ†é’Ÿï¼Œå› ä¸ºéœ€è¦ä¸‹è½½ä¾èµ–å’Œç¼–è¯‘

### æ–¹æ³• 2ï¼šåˆ†æ­¥è°ƒè¯•

```bash
# 1. ç¡®ä¿å¼€å‘æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼ˆæ–°ç»ˆç«¯çª—å£ï¼‰
pnpm dev

# 2. åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œ Android è°ƒè¯•
npx @tauri-apps/cli android dev
```

---

## ğŸ“± ç¬¬äº”æ­¥ï¼šæ‰‹æœºä¸Šæµ‹è¯•å®‰å…¨åŒºåŸŸ

åº”ç”¨å®‰è£…åï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

### âœ… é¢„æœŸæ•ˆæœ
- é¡¶éƒ¨å¯¼èˆªæ ä¸ä¼šè¢«çŠ¶æ€æ é®æŒ¡
- åº•éƒ¨æ ‡ç­¾æ ä¸ä¼šè¢«è™šæ‹Ÿå¯¼èˆªé”®é®æŒ¡
- å†…å®¹åŒºåŸŸå®Œæ•´å¯è§ï¼Œå¯ä»¥æ­£å¸¸æ»šåŠ¨
- ç‚¹å‡»ã€Œæ˜¾ç¤ºé€šçŸ¥ã€ã€ã€Œæ˜¾ç¤ºå¯¹è¯æ¡†ã€ç­‰æŒ‰é’®æœ‰å“åº”

### ğŸ“¸ æµ‹è¯•æ¸…å•
- [ ] çŠ¶æ€æ å’Œå¯¼èˆªæ ä¹‹é—´æ²¡æœ‰é‡å 
- [ ] æ ‡ç­¾æ å’Œè™šæ‹Ÿé”®ä¹‹é—´æ²¡æœ‰é‡å 
- [ ] å¯ä»¥æ­£å¸¸æ»šåŠ¨å†…å®¹
- [ ] ç‚¹å‡»äº‹ä»¶æ­£å¸¸å“åº”
- [ ] Toastã€Dialog æ­£å¸¸æ˜¾ç¤º
- [ ] æ—‹è½¬å±å¹•åå¸ƒå±€æ­£å¸¸

---

## ğŸ”„ çƒ­é‡è½½æµ‹è¯•

ä¿®æ”¹ä»£ç åï¼Œåº”ç”¨ä¼šè‡ªåŠ¨é‡è½½ï¼š

1. ç¼–è¾‘ `src/App.vue`ï¼Œæ¯”å¦‚ä¿®æ”¹æ ‡é¢˜
2. ä¿å­˜æ–‡ä»¶
3. æ‰‹æœºä¸Šåº”ç”¨ä¼šè‡ªåŠ¨åˆ·æ–°

**æ³¨æ„**ï¼šRust ä»£ç ä¿®æ”¹éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œéœ€è¦æ›´é•¿æ—¶é—´

---

## ğŸ—ï¸ æ„å»ºç”Ÿäº§ç‰ˆæœ¬ APK

### Debug ç‰ˆæœ¬ï¼ˆæµ‹è¯•ç”¨ï¼‰
```bash
npx @tauri-apps/cli android build
```

APK ä½ç½®ï¼š
```
src-tauri/gen/android/app/build/outputs/apk/universal/debug/app-universal-debug.apk
```

### Release ç‰ˆæœ¬ï¼ˆå‘å¸ƒç”¨ï¼‰
```bash
npx @tauri-apps/cli android build --release
```

APK ä½ç½®ï¼š
```
src-tauri/gen/android/app/build/outputs/apk/universal/release/app-universal-release.apk
```

---

## ğŸ“² å®‰è£… APK åˆ°æ‰‹æœº

### æ–¹æ³• 1ï¼šä½¿ç”¨ ADB å®‰è£…
```bash
adb install path/to/app.apk

# å¼ºåˆ¶è¦†ç›–å®‰è£…
adb install -r path/to/app.apk
```

### æ–¹æ³• 2ï¼šé€šè¿‡æ–‡ä»¶ç®¡ç†å™¨
1. å°† APK æ–‡ä»¶ä¼ è¾“åˆ°æ‰‹æœº
2. ä½¿ç”¨æ–‡ä»¶ç®¡ç†å™¨æ‰“å¼€ APK
3. ç‚¹å‡»å®‰è£…

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šæ„å»ºå¤±è´¥ - Gradle é”™è¯¯

```bash
# æ¸…ç† Gradle ç¼“å­˜
cd src-tauri/gen/android
./gradlew clean

# é‡æ–°æ„å»º
cd ../../..
npx @tauri-apps/cli android build
```

### é—®é¢˜ 2ï¼šåº”ç”¨å®‰è£…å¤±è´¥

```bash
# å¸è½½æ—§ç‰ˆæœ¬
adb uninstall com.express.app

# é‡æ–°å®‰è£…
adb install -r path/to/app.apk
```

### é—®é¢˜ 3ï¼šè¿æ¥ WebView å¤±è´¥

æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®ï¼š
```bash
# æ£€æŸ¥ 1420 ç«¯å£æ˜¯å¦åœ¨ç›‘å¬
lsof -i :1420

# å¦‚æœæ²¡æœ‰ï¼Œé‡å¯å¼€å‘æœåŠ¡å™¨
pnpm dev
```

### é—®é¢˜ 4ï¼šå®‰å…¨åŒºåŸŸä¸ç”Ÿæ•ˆ

1. æ£€æŸ¥ `index.html` çš„ viewport è®¾ç½®
2. ç¡®è®¤ Android ç³»ç»Ÿç‰ˆæœ¬ >= 9.0
3. åœ¨ Chrome DevTools ä¸­æ£€æŸ¥ CSS å˜é‡

### é—®é¢˜ 5ï¼šå°ç±³æ‰‹æœºç‰¹æœ‰é—®é¢˜ - MIUI ä¼˜åŒ–

æŸäº›å°ç±³æ‰‹æœºå¯èƒ½æœ‰é¢å¤–é™åˆ¶ï¼š

1. **å…³é—­ MIUI ä¼˜åŒ–**ï¼š
   - å¼€å‘è€…é€‰é¡¹ â†’ å…³é—­ã€ŒMIUI ä¼˜åŒ–ã€
   - é‡å¯æ‰‹æœº

2. **å…è®¸åå°è¿è¡Œ**ï¼š
   - è®¾ç½® â†’ åº”ç”¨è®¾ç½® â†’ åº”ç”¨ç®¡ç† â†’ Express App
   - çœç”µç­–ç•¥ â†’ æ— é™åˆ¶
   - è‡ªå¯åŠ¨ â†’ å…è®¸

---

## ğŸ“Š æ€§èƒ½è°ƒè¯•

### æŸ¥çœ‹æ—¥å¿—
```bash
# å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—
adb logcat | grep -i "express\|tauri\|rust"

# æ¸…ç©ºæ—¥å¿—
adb logcat -c
```

### Chrome DevTools è°ƒè¯•

1. æ‰‹æœºè¿æ¥åï¼Œè®¿é—®ï¼š`chrome://inspect`
2. æ‰¾åˆ°ä½ çš„åº”ç”¨
3. ç‚¹å‡»ã€Œinspectã€
4. å¯ä»¥æŸ¥çœ‹ Consoleã€Networkã€Elements ç­‰

---

## ğŸ¯ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# æ£€æŸ¥è®¾å¤‡è¿æ¥
adb devices

# å¯åŠ¨å¼€å‘æ¨¡å¼
npx @tauri-apps/cli android dev

# æ„å»º Debug APK
npx @tauri-apps/cli android build

# æ„å»º Release APK
npx @tauri-apps/cli android build --release

# å®‰è£… APK
adb install -r path/to/app.apk

# å¸è½½åº”ç”¨
adb uninstall com.express.app

# æŸ¥çœ‹æ—¥å¿—
adb logcat | grep -i tauri

# é‡å¯ ADB
adb kill-server && adb start-server

# æˆªå›¾
adb shell screencap -p /sdcard/screenshot.png
adb pull /sdcard/screenshot.png

# å½•å±
adb shell screenrecord /sdcard/demo.mp4
# Ctrl+C åœæ­¢
adb pull /sdcard/demo.mp4
```

---

## ğŸ“š ç›¸å…³èµ„æº

- [Tauri Android æ–‡æ¡£](https://tauri.app/zh-cn/start/prerequisites/#android)
- [ADB å‘½ä»¤å‚è€ƒ](https://developer.android.com/studio/command-line/adb)
- [å°ç±³å¼€å‘è€…é€‰é¡¹è¯´æ˜](https://www.mi.com/service/support/)

---

## âœ… å‡†å¤‡å°±ç»ªæ£€æŸ¥æ¸…å•

åœ¨è¿æ¥æ‰‹æœºå‰ï¼Œè¯·ç¡®è®¤ï¼š

- [x] Android é¡¹ç›®å·²åˆå§‹åŒ–
- [x] ADB å·¥å…·å¯ç”¨
- [x] ç¯å¢ƒå˜é‡å·²é…ç½®
- [x] å¼€å‘æœåŠ¡å™¨å¯ä»¥å¯åŠ¨ï¼ˆç«¯å£ 1420ï¼‰
- [ ] æ‰‹æœºå·²å¼€å¯ USB è°ƒè¯•
- [ ] æ‰‹æœºå·²è¿æ¥å¹¶æˆæƒ
- [ ] `adb devices` æ˜¾ç¤ºè®¾å¤‡

**å‡†å¤‡å¥½åï¼Œè¿æ¥ä½ çš„å°ç±³æ‰‹æœºï¼Œè¿è¡Œï¼š**

```bash
adb devices
```

çœ‹åˆ°è®¾å¤‡åï¼Œè¿è¡Œï¼š

```bash
npx @tauri-apps/cli android dev
```

---

**ç¥ä½ è°ƒè¯•é¡ºåˆ©ï¼ğŸ‰**


